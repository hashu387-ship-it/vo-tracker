
const rawData = `1	ETS Room Standby Equipment Removal	8/6/24	VO	FFC06HW2-GENCORR-000182	FFC06HW2-GENCORR-000182				 (436,711.91)	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0002		R06-HW2C05-TRS-DVO-CM-0002			Closed Out 	
2	 Change in Generator from Biofuel to Standard Tier 1 Diesel 	6/9/24	VO	TRS06HW2-GENCORR-000846	TRS06HW2-GENCORR-000846				 (1,050,000.00)	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0001		R06-HW2C05-TRS-DVO-CM-0001			Closed Out 	
3	Issued for Construction (IFC N1) Documents Buildings	9/7/24	VO	FFC06HW2-GENCORR-000187	FFC06HW2-GENCORR-000190				 1,100,693.07 	DVO RR Issued	R06-HW2C05-TRS-DVO-CM-0005		R06-HW2C05-TRS-DVO-CM-0005			Closed Out 	
4	 Issued for Construction (IFC N1) Documents Infra 	9/3/24	VO	FFC06HW2-GENCORR-000187	FFC06HW2-GENCORR-000187				 3,001,607.58 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0005		R06-HW2C05-TRS-DVO-CM-0005			Closed Out 	
5	Issued for Construction (IFC N1) Documents Pool	9/4/24	VO	FFC06HW2-GENCORR-000187	FFC06HW2-GENCORR-000189				 558,521.84 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0005		R06-HW2C05-TRS-DVO-CM-0005			Closed Out 	
6	 Changing ACCU Room to Storage Room in Asset 60 (HOH) 	9/17/24	VO	FFC06HW2-GENCORR-000192	FFC06HW2-GENCORR-000192				 15,581.88 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0008		R06-HW2C05-TRS-DVO-CM-0008			Closed Out 	
7	Relocation of CCTV cameras (6 nr) to meet operational requirements	1/4/25	VO	FFC06HW2-GENCORR-000207	FFC06HW2-GENCORR-000207		 (40,876.88)	 -   	 -   	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0007		R06-HW2C05-TRS-DVO-CM-0007			Closed Out 	
8	 MEP Works inside Villas & Clusters Bathrooms and associated Interfaces 	2/16/25	VO	FFC06HW2-GENCORR-000212	FFC06HW2-GENCORR-000261		 10,699,031.00 		 10,699,031.00 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0015		R06-HW2C05-TRS-DVO-CM-0015			Closed Out 	
9	MEP works / Pool works at HW1		Mail				 1,000,190.94 	 1,000,190.94 	 1,000,190.94 	Approved & Awaiting for the DVO to be issued HW1						FFC agreed with RSG value; DVO to be processed	FFC Agreed
10	 Sewage Network final Tie-in to PPP Manhole - Additional Lift Station 	5/19/25	VO	FFC06HW2-GENCORR-000343	FFC06HW2-GENCORR-000368	8/4/25	 635,771.67 	 519,455.46 	 519,455.46 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0022		R06-HW2C05-TRS-DVO-CM-0022			Closed Out 	
11	Change from 13A single switch outlet to 13A twin switched socket outlet for the Minibar Fridge on HW2 Villas and Clusters	7/15/25	VO	"FFC06HW2-GENCORR-000413"	"FFC06HW2-GENCORR-000413"	7/20/25	 19,944.67 	 17,343.19 	 17,343.19 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0025		R06-HW2C05-TRS-DVO-CM-0025			Closed Out 	FFC Agreed
12	 Changing Backup Strategy to Equipment Serving ICT Rooms Instruction Reference 	2/4/25	VO	FFC06HW2-GENCORR-000247	FFC06HW2-GENCORR-000247		 (278,670.94)	 (747,365.98)	 (504,221.15)	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0004		R06-HW2C05-TRS-DVO-CM-0004			Closed Out 	
13	Supplementary Conduit and Embedded Works for speciality restaurant and long bar and pool	5/27/24	Gen CORR	FFC06HW2-GENCORR-000158	FFC06HW2-GENCORR-000158		 16,678.63 			Pending with RSG						Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
14	 Cable Copper Price Fluctuation 	25/09/2024	Gen CORR	FFC06HW2-GENCORR-000193	FFC06HW2-GENCORR-000193		 3,010,759.61 	 395,793.54 		Pending with RSG/FFC						RSG  sent and assesment and dicussion in undergoing to finalase with RSG 	Under RSG & FFC
15	Embeded pressurized pipelines	10/15/25	Gen CORR	FFC06HW2-GENCORR-000471	FFC06HW2-RESP-000053		 2,891,331.24 			Pending with RSG						Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
16	 Kitchen Drainage Pipe Installation 	2/5/25	Gen CORR	FFC06HW2-GENCORR-000248	FFC06HW2-GENCORR-000248		 95,183.74 			Pending with RSG						Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
17	Reduction of the primary irrigation loop along with Points of Connections (POCs)	2/3/25	VO	FFC06HW2-GENCORR-000246	FFC06HW2-GENCORR-000246	6/22/25	 174,014.11 	 (35,608.36)		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0016					Expected  Amount as per the Latest meeting with RSG 23rd JUL 2025- 70,000 but RSG sent an revised assesment  -35,608.36 and dicussion in undergoing to finalize with RSG 	Under RSG & FFC
18	 Omission of Fire Dampers Mounted on 1 Hour Fire Rated Walls 	8/2/25	VO	FFC06HW2-GENCORR-000250	FFC06HW2-GENCORR-000250		 (123,292.18)			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0011					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
19	Change of Fire-rated Cables Buried in the Infrastructure	2/15/25	VO	FFC06HW2-GENCORR-000259	FFC06HW2-GENCORR-000259	6/11/25	 20,153.09 	 (271,010.81)		Pending with RSG	R06-HW2C05-TRS-VOR-CM-0014					FFC Sent all related documents to RSG to support  there Proposal waiting Reply From RSG 	Under process
20	 Omission of External Emergency Lights above Fire Hose Cabinet 	2/15/25	VO	FFC06HW2-GENCORR-000260	FFC06HW2-GENCORR-000260		 (76,534.43)			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0013					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
21	R06-HW2C05-Costs Proposal For Modification to Telephone Operator Room in HOH (Asset 60)	3/19/25	VO	FFC06HW2-GENCORR-000306	FFC06HW2-GENCORR-000306		 3,871.55 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0017_C0					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under process
22	 Connection of Pool Overflow Drain to Sump Pit instead of Manhole 	8/6/25	VO	FFC06HW2-GENCORR-000440	FFC06HW2-GENCORR-000440		 194,460.10 	 85,383.54 		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0018					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under RSG & FFC
23	MEP related works associated with the construction of the First in Place (FIP) villa pool (Asset 30-04)	10/5/25	VO	FFC06HW2-GENCORR-000457	FFC06HW2-GENCORR-000457		 58,252.90 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0030 (Rev.1)					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
24	 Provision of Temporary Cooling to First In Place Assets 	7/19/25	VO	FFC06HW2-GENCORR-000415	FFC06HW2-GENCORR-000415	8/23/25	 669,692.26 	 372,927.79 	 372,927.79 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0020		R06-HW2C05-TRS-DVO-CM-0020			Closed Out 	
25	Cost Proposal For Damage No 21 Chilled Water Pipe (Zone 4, Asset 31-04B)	7/22/25	Gen CORR	FFC06HW2-GENCORR-000418	FFC06HW2-GENCORR-000418		 1,260,532.47 			Pending with RSG						Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
26	 Cost propoal for Deisel Supply 	7/23/25	Gen CORR	FFC06HW2-GENCORR-000419	FFC06HW2-GENCORR-000419		 1,451,263.73 			Pending with RSG						Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
27	HW2C05 Ligting Control System	2/18/25	VO	FFC06HW2-GENCORR-000191	FFC06HW2-RESP-000056	4/8/25	 304,785.68 	 74,452.02 		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0005					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under process
28	 Omission of Fire Protection Inside Transformer Rooms 	8/25/25	VO	FFC06HW2-GENCORR-000211	FFC06HW2-GENCORR-000445	3/9/25	 (30,297.49)			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0006					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
29	Omission of FCU's Supplying Kitchen Preparation Rooms in HoH	1/6/25	VO	FFC06HW2-GENCORR-000208	FFC06HW2-GENCORR-000208	5/10/25	 (3,537.11)	 (23,701.71)		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0009					FFC Sent the justification for the RSG Comments	Under process
30	 Additional Fire Suppression system in the Signature Restaurant  	6/19/25	VO	FFC06HW2-GENCORR-000405	FFC06HW2-GENCORR-000405	7/20/25	 45,143.47 	 7,557.19 		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0019_C0					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under process
31	Omission of 13A twin socket outlets and Replace with combined MEP and ELV Faceplates	7/20/25	VO	FFC06HW2-GENCORR-000416	FFC06HW2-GENCORR-000416	8/5/25	 81,841.95 	 46,879.80 		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0027					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under RSG/FFC
32	 Cost proposal for Change in Bollard Lighting Fixtures luminaire ref. LA1  	6/24/25	VO	FFC06HW2-GENCORR-000406	FFC06HW2-GENCORR-000406	7/23/25	 318,771.22 	 (273,227.40)		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0026					FFC Sent the justification for the RSG Comments	Under process
33	Provision of electrical power connection on motorised roller shutter in the kitchen areas at HOH (Asset 60)	7/17/25	VO	FFC06HW2-GENCORR-000414	FFC06HW2-GENCORR-000414	7/19/25	 10,722.34 	 1,659.95 		Pending with RSG/FFC	R06-HW2C05-TRS-VOR-CM-0024					RSG  sent and assesment dicussion in undergoing to finalase with RSG 	Under process
34	 HW2 Family Pool Enlargement 	9/30/25	VO	FFC06HW2-GENCORR-000244	FFC06HW2-GENCORR-000244	10/6/25	 1,166,471.16 	 912,623.79 	 912,623.79 	DVO RR Issued	R06-HW2C05-TRS-VOR-CM-0012		 R06-HW2C05-TRS-DVO-CM-0012_C0			Closed Out 	
35	"MEP related changes to the cabanas"	9/22/25	VO	FFC06HW2-GENCORR-000453	FFC06HW2-GENCORR-000453		 184,530.84 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0031					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
36	 MEP works required due to relocation of Villa External Areas Showers 	10/18/25	VO	FFC06HW2-GENCORR-000490	FFC06HW2-GENCORR-000491		 102,059.80 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0023					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
37	MEP provisions related to the cocoon water feature in the reception area of the Arrival building (Asset-10).	11/16/25	VO	FFC06HW2-GENCORR-000506	FFC06HW2-GENCORR-000506		 300,617.66 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0028					Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
38	 Main Pool Bar - Sunken Bar Drain Piping to Waste Network 	8/21/25	VO	FFC06HW2-GENCORR-000443	FFC06HW2-GENCORR-000443		 10,039.58 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0021_C0					Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
39	Cost Proposal for the operation and maintenance of temporary MEP supplies in HW03 & HW04	8/30/25	Gen CORR	FFC06HW2-GENCORR-000448	FFC06HW2-GENCORR-000448		 423,764.00 			Pending with RSG						Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
40	 Type of Air Outlets Change from SLD to FBD by ID - All FOH Buildings 	10/29/25	VO	FFC06HW2-GENCORR-000495	FFC06HW2-GENCORR-000495		 768,866.49 			Pending with RSG						Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
41	Cost Proposal for SPA - Addition of Missed Small Power and Data Requirements	10/15/25	VO	FFC06HW2-GENCORR-000488	FFC06HW2-GENCORR-000488		 18,087.77 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0035					Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
42	 Simplification of Pools Channel Detailing in 10 nr 3 Bedroom Villa Pools 	10/5/25	VO	"FFC06HW2-GENCORR-000456"	"FFC06HW2-GENCORR-000456"		 18,314.80 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0032					Documents are submitted officially on ACONEX waiting for RSG Assessment	Under RSG assessment
43	Supply and installation of the required missing kitchen drainage pipelines in the Kitchen Areas at Amenity & HOH buildings	10/11/25	VO	"	FFC06HW2-GENCORR-000463"	FFC06HW2-GENCORR-000463		 100,533.74 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0033					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
44	 Cost proposal for Omit 2Nr. of Inaccessible Wall Sockets (EE-PL38) and Replace with 2Nr Floor Box having 1Nr Outlet (Electrical Provision) at Asset-14 (Children & Teen Center Bldg.) 	9/25/25	VO	FFC06HW2-GENCORR-000454	FFC06HW2-GENCORR-000454		 3,242.53 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0039					Documents are submitted officially on ACONEX wating for RSG Assessment	Under RSG assessment
45	 Supply and Installation of cable containment for GSM Hybrid Cables		VO							Pending with RSG	R06-HW2C05-TRS-VOR-CM-0037					already reply to the VOR asking for more information comparison was done comparing the real work on site and with proposed  sketch	Under process
46	 RE: GW Light fitting to Villa terraces - Request for Quotation/Pricing 	11/26/25	Email				 270,716.16 			Pending with RSG						Documents are submitted via  Email and wating for RSG Response	Under process
47	Request for Quotation/ Pricing - HW2 Maintenance of Temporary Utilities & Switch over to Permanent Power	11/20/25	Gen CORR	FFC06HW2-GENCORR-000508	FFC06HW2-GENCORR-000508		 3,423,318.95 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0041					Documents are submitted officially on ACONEX and wating for RSG Assessment	Under RSG assessment
48	 Re: TMV location change in HW2 villas pantry 	11/6/25	Gen CORR	FFC06HW2-GENCORR-000496	FFC06HW2-GENCORR-000496		 152,696.30 			Pending with RSG						Documents are submitted officially on ACONEX and wating for RSG Assessment	Under RSG assessment
49	RFI-Change in Air Outlet Type and Size for Asset 60 (HOH) and Asset 61 (Utility Hub)	11/9/25	RFI	FFC06HW2-GENCORR-000497	FFC06HW2-GENCORR-000497		 179,556.66 			Pending with RSG						Documents are submitted officially on ACONEX and wating for RSG Assessment	Under RSG assessment
50	 Exterior Lighting Installation 	11/19/25	Email				 177,732.09 			Pending with RSG						Documents are submitted via email and wating for RSG Assessment	Under RSG assessment
51	Supply and Installation of (Direct-buried type) Valve for Potable Water & Irrigation System	12/14/25	VO	FFC06HW2-GENCORR-000519	FFC06HW2-GENCORR-000519		 631,521.67 			Pending with RSG	R06-HW2C05-TRS-VOR-CM-0034					Documents are submitted officially on ACONEX and wating for RSG Assessment	Under RSG assessment
52	 Addition of external signage control panel's and ommission of the generator annunciator panel in the Fire Command Centre 		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0036					Material Submittel In Process Once Approve Will Be Get The Qoutation 	Under process
53	"Proposed changes to ICT rooms Air Outlet type and\\nsize for Asset 10 (Arrival Hub), Asset 13 (Meeting Room) and Asset 14 (Children Center)"		RFI							Pending with FFC						Still No Reply From Rsg And Waiting For The Confirmation From Rsg	Under Process
54	 R06-HW2C05 Variation Order No. 0050 Implementation of Changes Following Operator and RSG Inspection â€“ FIP Villa and Cluster (MEP Works) 		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0050_C0					FFC Working  For Submission	Under process
55	R06-HW2C05 Variation Order No. 046 Removal of foot wash (bib taps) on the entrance of 3 Bedroom type villas; including relocation of shower drain piping works of 3-Bedroom and 4-Bedroom		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0046_C0					Already Submitted Shower Drain Location In Another Vo 	Under process
56	 Addition of EV Charging Station for Hotel Asset Staff Vehicles 		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0038					With Eng Foad	Under process
57	Replacement of FOH Panic Bar Hardware on External Doors for Assets 10, 13, 22, and 23 (MEP Works		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0043					Have To Coordinate With Other Contractor As Per There Drawing Determin The Quantities	Under process
58	 Omission of Bathroom Downlights which are to be free-issued to the MEP Contractor that were supplied by the Bathroom Pod Contractor (SBW) 		VO							Pending with FFC	R06-HW2C05-TRS-VOR-CM-0010					Waiting Confirmation And Clearification From Eng Foad	Under process`;

function parseCurrency(str) {
    if (!str || str.trim() === '-' || str.trim() === '') return null;
    let cleanStr = str.replace(/,/g, '').trim();
    if (cleanStr.startsWith('(') && cleanStr.endsWith(')')) {
        cleanStr = '-' + cleanStr.slice(1, -1);
    }
    return parseFloat(cleanStr);
}

function parseDate(str) {
    if (!str || str.trim().length === 0 || str.trim() === '-' || str.includes('Not in source') || str.includes('Wait')) return new Date();
    // Try D/M/Y
    const parts = str.trim().split('/');
    if (parts.length === 3) {
        let year = parseInt(parts[2]);
        if (year < 100) year += 2000;
        return new Date(`${year}-${parts[0]}-${parts[1]}`);
    }
    // Try D-M-Y with dashes
    const partsDash = str.trim().split('-');
    if (partsDash.length === 3) {
        let year = parseInt(partsDash[2]);
        if (year < 100) year += 2000;
        return new Date(`${year}-${partsDash[1]}-${partsDash[0]}`);
    }
    const tried = new Date(str);
    if (!isNaN(tried.getTime())) return tried;
    return new Date();
}

function mapStatus(statusText) {
    const s = statusText.trim().toLowerCase();

    if (s.includes('dvo rr issued')) return 'DVORRIssued';
    if (s.includes('closed out')) return 'DVORRIssued';
    if (s.includes('approved') && s.includes('dvo')) return 'ApprovedAwaitingDVO';
    if (s.includes('rsg') && s.includes('ffc')) return 'PendingWithRSGFFC';
    if (s.includes('pending with rsg')) return 'PendingWithRSG';
    if (s.includes('pending with ffc')) return 'PendingWithFFC';
    if (s.includes('rsg')) return 'PendingWithRSG';
    if (s.includes('ffc')) return 'PendingWithFFC';

    return 'PendingWithFFC';
}

function main() {
    const lines = rawData.split('\n');
    const vos = [];

    for (const line of lines) {
        if (!line.trim()) continue;

        // Split by tabs
        const parts = line.split('\t').map(p => p.trim());

        // Parts structure:
        // 0: S.No
        // 1: Subject
        // 2: Date
        // 3: Type
        // 4: Sub Ref
        // 5: Resp Ref
        // 6: Assessment Date?
        // 7: Proposal Value
        // 8: RSG Assessment
        // 9: Approved Amount
        // 10: Status
        // 11: VOR Ref
        // 12: VOR Date (often empty)
        // 13: DVO Ref
        // 14: DVO Date
        // 15: EMPI Date
        // 16: Remarks
        // 17: Live Action

        const subject = parts[1];
        if (!subject) continue;

        const submissionDate = parseDate(parts[2]);
        const submissionType = parts[3]?.replace(' ', '') || 'VO';
        const submissionReference = parts[4] === '-' || parts[4] === '' ? null : parts[4].replace(/"/g, '');
        const responseReference = parts[5] === '-' || parts[5] === '' ? null : parts[5].replace(/"/g, '');

        const proposalValue = parseCurrency(parts[7]);
        const assessmentValue = parseCurrency(parts[8]);
        const approvedAmount = parseCurrency(parts[9]);

        const status = mapStatus(parts[10] || '');

        const vorReference = parts[11];
        const dvoReference = parts[13];

        const remarks = parts[16];
        const actionNotes = parts[17];

        vos.push({
            subject: subject.replace(/"/g, '').replace(/(\r\n|\n|\r)/gm, ""),
            submissionDate,
            submissionType,
            submissionReference,
            responseReference,
            proposalValue,
            assessmentValue,
            approvedAmount,
            status,
            vorReference,
            dvoReference,
            remarks,
            actionNotes
        });
    }

    console.log(JSON.stringify(vos, null, 2));
}

main();
